---
layout: guide

permalink: /jumpto/utf-8/
root: ../..
title: "UTF-8 (Unicode) und seltsame Zeichen"
group: "Allgemein"
orderId: 7

creator: hausl
author:
    -   name: hausl
        profile: 21246

inhalt:
    -   name: "Seltsame Zeichen - Warum?"
        anchor: hintergrund
        simple: "Hintergrund"

    -   name: "Wie man es richtig macht"
        anchor: konsequent-utf-8
        simple: "Konsequent UTF-8 nutzen"

    -   name: "Quellen"
        anchor: quellen
        simple: ""


entry-type: in-progress
---

### [Seltsame Zeichen - Warum?](#hintergrund)
{: #hintergrund}

> *"Warum werden auf meiner Seite Umlaute und Sonderzeichen falsch darsgestellt?"* <br>
<br>
Nicht selten gibt es Themen auf php.de wie diese; Probleme mit Umlauten und anderen Sonderzeichen,
die fehlerhaft dargestellt werden. In folgenden werden die Situationen, basierend auf
den beiden Kodierungen UTF-8 (Unicode) und ISO 8859-1 (Latin-1) gezeigt.


Wenn ein Dokument als Unicode (UTF-8) abgespeichert wurde, jedoch als ISO 8859-1 interpretiert wird, geschieht folgendes:

~~~
Erwartete Ausgabe: ä  ö  ü
Wirkliche Ausgabe: Ã¤ Ã¶ Ã¼
~~~

Das `ä` wurde binär gesehen als `11000011 10100100` gespeichert. Die beiden Bytes gehören laut UTF-8 zusammen,
werden in ISO 8859-1 allerdings auseinander genommen. Folglich wird aus `11000011` ein `Ã` und aus `10100100` ein `¤`-Zeichen.


Mögliche Ursache

* Für den Header/Metatag ist charset als UTF-8 gesetzt, die Seiten sind jedoch nicht als UTF-8 gespeichert
oder die Zeichen stammen aus einer nicht UTF-8 Fremdquelle (Datenbank, Datei, Window-System..)


Wenn die Umlaute als Fragezeichen dargestellt werden, dann wird ein als ISO 8859-1 kodiertes Dokument als UTF-8
interpretiert. Dies stellt das Gegenstück zur oben genannten Situation dar.

~~~
Erwartete Ausgabe: ä  ö  ü
Wirkliche Ausgabe: �  �  �
~~~

Mit anderen Worten wurde hier ein `ä` als `11100100` gespeichert. In UTF-8 ist dieses Byte jedoch **ungültig**, wird also nicht
angezeigt oder ignoriert, bzw. als `?` oder `�` dargestellt.

Mögliche Ursache

* Fehlender oder falscher Header/Metatag. Ein `header('Content-Type: text/html; charset=UTF-8');` im PHP-Script löst
in vielen Fällen schon das Problem.

* Oder eine sog. Überkodierung: header und Zeichen sind UTF-8, dennoch irgendwo zusätzlich ein `utf8_encode()` (zuviel).


### [Wie man es richtig macht: Nutze konsequent UTF-8](#konsequent-utf-8)
{: #konsequent-utf-8}

Checkliste für UTF-8 und Umlautprobleme - gesammelte Hinweise aus PHP.de Beiträgen

* PHP- und HTML-/Template-Dateien im Editor als *UTF-8 ohne BOM* speichern. Dies betrifft auch alle etwaigen serverseitigen inkludierten Dateien.

* HTTP Header Content-Type mit UTF-8 => `header('Content-Type: text/html; charset=UTF-8');`

* HTML-meta-Tag
    * HTML 4.x: `<meta http-equiv="content-type" content="text/html; charset=utf-8" />`
    * HTML 5: `<meta charset="utf-8">`<br>

* Formulardaten in UTF-8 übergeben (ggf. mit `accept-charset="utf-8"` sicherstellen)

* Datenbank Zeichensatz UTF-8, Tabellenkollationen `utf8_general_ci` o.ä.
Siehe auch [MySQL und UTF-8](http://php-de.github.io/jumpto/mysql-and-utf8/)

* Datenbankverbindung von PHP zur Datenbank (zB MySQL) auf UTF-8 stellen.
Siehe auch [MySQL und UTF-8](http://php-de.github.io/jumpto/mysql-and-utf8/)

* Daten aus Fremdquellen müssen mittels `utf8_encode()` in  UTF-8 überführt werden, wenn sie nicht als UTF-8 vorliegen.

* Bei der Anwendung von htmlspecialchars() und htmlentities() die Codierung mitgeben. Beispiel (HTML 5) für htmlspecialchars():
    ~~~php
    function escape($s) {
        return htmlspecialchars(
            $s,
            ENT_QUOTES | ENT_HTML5 | ENT_DISALLOWED | ENT_SUBSTITUTE,
            'UTF-8'
        );
    }
    ~~~

* Für deutsche Monatsnamen wie März ist u.U. `setlocale(LC_TIME, "de_DE.utf8")` notwendig



### [Quellen](#quellen)
{: #quellen}

* [http://www.php.de/forum/webentwicklung/php-einsteiger/1448531-umlaute-im-tiptext?p=1448599#post1448599](http://www.php.de/forum/webentwicklung/php-einsteiger/1448531-umlaute-im-tiptext?p=1448599#post1448599)
* [http://floern.com/webscripting/umlautproblem](http://floern.com/webscripting/umlautproblem)
